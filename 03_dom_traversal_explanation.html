<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Traversal - Detailed Explanation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #27ae60;
            margin-top: 30px;
        }
        
        h3 {
            color: #e74c3c;
            margin-top: 25px;
        }
        
        .code-block {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .highlight {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        
        .warning {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
        }
        
        .info {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
        }
        
        .success {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        table, th, td {
            border: 1px solid #ddd;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .method-card {
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            background-color: #f8f9fa;
        }
        
        .performance-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .performance-good {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
        }
        
        .performance-bad {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
        }
        
        .selector-examples {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .tree-visual {
            font-family: monospace;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #dee2e6;
            margin: 20px 0;
            white-space: pre;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>DOM Traversal - Navigation and Element Finding</h1>
        
        <div class="info">
            <strong>Learning Objectives:</strong>
            <ul>
                <li>Master different DOM traversal techniques</li>
                <li>Understand query methods and their performance implications</li>
                <li>Learn advanced navigation patterns</li>
                <li>Apply best practices for efficient DOM traversal</li>
            </ul>
        </div>

        <h2>1. What is DOM Traversal?</h2>
        
        <p>DOM traversal is the process of moving through the document structure to find, access, or manipulate specific elements. It's like navigating a family tree - you can move between parents, children, and siblings, or search for specific relatives.</p>

        <div class="tree-visual">HTML Document Tree:

document
└── html
    ├── head
    │   ├── title
    │   └── meta
    └── body
        ├── header
        │   ├── h1
        │   └── nav
        │       └── ul
        │           ├── li (class="active")
        │           ├── li
        │           └── li
        ├── main
        │   ├── section (id="content")
        │   │   ├── article
        │   │   └── aside
        │   └── section
        └── footer
        </div>

        <h2>2. Types of DOM Traversal</h2>

        <div class="method-grid">
            <div class="method-card">
                <h3>1. Relational Navigation</h3>
                <p>Moving between elements based on their family relationships</p>
                <ul>
                    <li>Parent ↑ Child</li>
                    <li>Sibling ↔ Sibling</li>
                    <li>Ancestor ↑↑ Descendant</li>
                </ul>
            </div>
            
            <div class="method-card">
                <h3>2. Query-Based Finding</h3>
                <p>Searching for elements using selectors or attributes</p>
                <ul>
                    <li>By ID, class, tag</li>
                    <li>CSS selectors</li>
                    <li>Attribute matching</li>
                </ul>
            </div>
            
            <div class="method-card">
                <h3>3. Tree Walking</h3>
                <p>Systematically visiting all nodes in the DOM</p>
                <ul>
                    <li>Recursive traversal</li>
                    <li>Depth-first search</li>
                    <li>Breadth-first search</li>
                </ul>
            </div>
        </div>

        <h2>3. Relational Navigation Methods</h2>

        <table>
            <thead>
                <tr>
                    <th>Property</th>
                    <th>Direction</th>
                    <th>Returns</th>
                    <th>Example Usage</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>parentElement</code></td>
                    <td>Up ↑</td>
                    <td>Parent element</td>
                    <td>Get container of current element</td>
                </tr>
                <tr>
                    <td><code>children</code></td>
                    <td>Down ↓</td>
                    <td>HTMLCollection of children</td>
                    <td>Get all direct children</td>
                </tr>
                <tr>
                    <td><code>firstElementChild</code></td>
                    <td>Down ↓</td>
                    <td>First child element</td>
                    <td>Get first item in list</td>
                </tr>
                <tr>
                    <td><code>lastElementChild</code></td>
                    <td>Down ↓</td>
                    <td>Last child element</td>
                    <td>Get last item in list</td>
                </tr>
                <tr>
                    <td><code>nextElementSibling</code></td>
                    <td>Right →</td>
                    <td>Next sibling element</td>
                    <td>Move to next item</td>
                </tr>
                <tr>
                    <td><code>previousElementSibling</code></td>
                    <td>Left ←</td>
                    <td>Previous sibling element</td>
                    <td>Move to previous item</td>
                </tr>
            </tbody>
        </table>

        <h3>Practical Navigation Examples</h3>
        <div class="code-block">
// HTML: &lt;ul id="menu"&gt;&lt;li&gt;Home&lt;/li&gt;&lt;li class="active"&gt;About&lt;/li&gt;&lt;li&gt;Contact&lt;/li&gt;&lt;/ul&gt;

const activeItem = document.querySelector('.active');

// Navigate up to parent
const menu = activeItem.parentElement;
console.log(menu.id); // "menu"

// Navigate to siblings
const previousItem = activeItem.previousElementSibling;
console.log(previousItem.textContent); // "Home"

const nextItem = activeItem.nextElementSibling;
console.log(nextItem.textContent); // "Contact"

// Navigate down from parent
const firstItem = menu.firstElementChild;
const lastItem = menu.lastElementChild;
const allItems = menu.children;

console.log(firstItem.textContent); // "Home"
console.log(lastItem.textContent); // "Contact"
console.log(allItems.length); // 3
        </div>

        <h2>4. Query Methods - Finding Elements</h2>

        <h3>Classic Methods (Legacy but still useful)</h3>
        <div class="method-grid">
            <div class="method-card">
                <h4>getElementById()</h4>
                <div class="code-block">
const element = document.getElementById('myId');
                </div>
                <p><strong>Returns:</strong> Single element or null</p>
                <p><strong>Performance:</strong> Very fast</p>
                <p><strong>Use when:</strong> You know the exact ID</p>
            </div>
            
            <div class="method-card">
                <h4>getElementsByClassName()</h4>
                <div class="code-block">
const elements = document.getElementsByClassName('myClass');
                </div>
                <p><strong>Returns:</strong> Live HTMLCollection</p>
                <p><strong>Performance:</strong> Fast</p>
                <p><strong>Use when:</strong> Finding elements by class</p>
            </div>
            
            <div class="method-card">
                <h4>getElementsByTagName()</h4>
                <div class="code-block">
const elements = document.getElementsByTagName('div');
                </div>
                <p><strong>Returns:</strong> Live HTMLCollection</p>
                <p><strong>Performance:</strong> Fast</p>
                <p><strong>Use when:</strong> Finding all elements of a type</p>
            </div>
        </div>

        <h3>Modern Query Methods (Recommended)</h3>
        <div class="method-grid">
            <div class="method-card">
                <h4>querySelector()</h4>
                <div class="code-block">
const element = document.querySelector('.class #id');
                </div>
                <p><strong>Returns:</strong> First matching element or null</p>
                <p><strong>Performance:</strong> Moderate (CSS parsing)</p>
                <p><strong>Use when:</strong> Complex selectors, single element</p>
            </div>
            
            <div class="method-card">
                <h4>querySelectorAll()</h4>
                <div class="code-block">
const elements = document.querySelectorAll('div.item');
                </div>
                <p><strong>Returns:</strong> Static NodeList</p>
                <p><strong>Performance:</strong> Moderate (CSS parsing)</p>
                <p><strong>Use when:</strong> Complex selectors, multiple elements</p>
            </div>
        </div>

        <h3>CSS Selector Examples</h3>
        <div class="selector-examples">
            <h4>Common CSS Selectors for DOM Traversal:</h4>
            <div class="code-block">
// Basic selectors
document.querySelector('#myId')              // ID selector
document.querySelector('.myClass')           // Class selector
document.querySelector('div')                // Tag selector

// Combination selectors
document.querySelector('div.container')      // div with class 'container'
document.querySelector('#nav li')            // li inside element with id 'nav'
document.querySelector('.menu > li')         // Direct li children of .menu

// Attribute selectors
document.querySelector('[data-id="123"]')    // Element with data-id="123"
document.querySelector('input[type="text"]') // Text inputs
document.querySelector('[href^="https"]')    // Links starting with https

// Pseudo-selectors
document.querySelector('li:first-child')     // First li child
document.querySelector('li:last-child')      // Last li child
document.querySelector('li:nth-child(3)')    // Third li child
document.querySelector('tr:nth-child(odd)')  // Odd table rows

// Complex selectors
document.querySelector('.card:not(.disabled)')     // Cards that aren't disabled
document.querySelector('form input:required')      // Required inputs in forms
document.querySelector('.menu li:hover')           // Hovered menu items
            </div>
        </div>

        <h2>5. Live vs Static Collections</h2>

        <div class="warning">
            <h3>Understanding the Difference</h3>
            <p>This is crucial for avoiding bugs in your code!</p>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Collection Type</th>
                    <th>Updates with DOM?</th>
                    <th>forEach() method?</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>getElementsByClassName()</code></td>
                    <td>HTMLCollection</td>
                    <td>✅ Yes (Live)</td>
                    <td>❌ No</td>
                </tr>
                <tr>
                    <td><code>getElementsByTagName()</code></td>
                    <td>HTMLCollection</td>
                    <td>✅ Yes (Live)</td>
                    <td>❌ No</td>
                </tr>
                <tr>
                    <td><code>querySelectorAll()</code></td>
                    <td>NodeList</td>
                    <td>❌ No (Static)</td>
                    <td>✅ Yes</td>
                </tr>
                <tr>
                    <td><code>element.children</code></td>
                    <td>HTMLCollection</td>
                    <td>✅ Yes (Live)</td>
                    <td>❌ No</td>
                </tr>
            </tbody>
        </table>

        <h3>Live Collection Example</h3>
        <div class="code-block">
// Start with 3 divs in the document
const divs = document.getElementsByTagName('div');
console.log(divs.length); // 3

// Add a new div
const newDiv = document.createElement('div');
document.body.appendChild(newDiv);

// The collection automatically updates!
console.log(divs.length); // 4 (updated automatically)
        </div>

        <h3>Static Collection Example</h3>
        <div class="code-block">
// Start with 3 divs in the document
const divs = document.querySelectorAll('div');
console.log(divs.length); // 3

// Add a new div
const newDiv = document.createElement('div');
document.body.appendChild(newDiv);

// The collection stays the same
console.log(divs.length); // 3 (unchanged)

// Need to query again to get updated list
const updatedDivs = document.querySelectorAll('div');
console.log(updatedDivs.length); // 4
        </div>

        <h2>6. Advanced Traversal Techniques</h2>

        <h3>Tree Walking with Recursion</h3>
        <div class="code-block">
function walkDOM(element, callback, depth = 0) {
    // Process current element
    callback(element, depth);
    
    // Recursively process children
    Array.from(element.children).forEach(child => {
        walkDOM(child, callback, depth + 1);
    });
}

// Usage: Log all elements with indentation
walkDOM(document.body, (element, depth) => {
    const indent = '  '.repeat(depth);
    console.log(`${indent}${element.tagName}${element.id ? '#' + element.id : ''}${element.className ? '.' + element.className : ''}`);
});
        </div>

        <h3>Finding Elements by Custom Criteria</h3>
        <div class="code-block">
// Find all elements with specific data attributes
function findByDataAttribute(attribute, value, context = document) {
    return context.querySelectorAll(`[data-${attribute}="${value}"]`);
}

// Find elements containing specific text
function findByTextContent(text, context = document) {
    const elements = [];
    const walker = document.createTreeWalker(
        context,
        NodeFilter.SHOW_ELEMENT,
        {
            acceptNode: function(node) {
                return node.textContent.includes(text) ? 
                    NodeFilter.FILTER_ACCEPT : 
                    NodeFilter.FILTER_REJECT;
            }
        }
    );
    
    let node;
    while (node = walker.nextNode()) {
        elements.push(node);
    }
    return elements;
}

// Find parent element that matches condition
function findClosestParent(element, condition) {
    let current = element.parentElement;
    while (current && current !== document.body) {
        if (condition(current)) {
            return current;
        }
        current = current.parentElement;
    }
    return null;
}

// Usage examples
const userCards = findByDataAttribute('type', 'user-card');
const errorElements = findByTextContent('Error:');
const formParent = findClosestParent(inputElement, el => el.tagName === 'FORM');
        </div>

        <h3>Efficient Path Generation</h3>
        <div class="code-block">
function getElementPath(element) {
    const path = [];
    let current = element;
    
    while (current && current !== document.body) {
        let selector = current.tagName.toLowerCase();
        
        // Add ID if available (makes path unique)
        if (current.id) {
            selector += `#${current.id}`;
            path.unshift(selector);
            break; // ID is unique, no need to go further
        }
        
        // Add classes
        if (current.className) {
            selector += `.${current.className.split(' ').join('.')}`;
        }
        
        // Add nth-child if no unique identifier
        if (!current.id && !current.className) {
            const siblings = Array.from(current.parentNode.children);
            const index = siblings.indexOf(current) + 1;
            selector += `:nth-child(${index})`;
        }
        
        path.unshift(selector);
        current = current.parentElement;
    }
    
    return path.join(' > ');
}

// Usage
const element = document.querySelector('.card .title');
console.log(getElementPath(element)); 
// Output: "div.container > div.card > h3.title"
        </div>

        <h2>7. Performance Optimization</h2>

        <div class="performance-comparison">
            <div class="performance-bad">
                <h4>❌ Poor Performance</h4>
                <div class="code-block">
// Repeated DOM queries
for (let i = 0; i < 100; i++) {
    const container = document.getElementById('container');
    const items = container.querySelectorAll('.item');
    // Process items...
}

// Inefficient selector
const elements = document.querySelectorAll('*');
elements.forEach(el => {
    if (el.classList.contains('target')) {
        // Process...
    }
});
                </div>
            </div>
            
            <div class="performance-good">
                <h4>✅ Good Performance</h4>
                <div class="code-block">
// Cache DOM references
const container = document.getElementById('container');
const items = container.querySelectorAll('.item');

for (let i = 0; i < 100; i++) {
    // Use cached references
    // Process items...
}

// Efficient selector
const elements = document.querySelectorAll('.target');
elements.forEach(el => {
    // Process...
});
                </div>
            </div>
        </div>

        <h3>Performance Best Practices</h3>
        <div class="success">
            <h4>Optimization Strategies:</h4>
            <ul>
                <li><strong>Cache frequently accessed elements</strong> in variables</li>
                <li><strong>Use specific selectors</strong> instead of broad searches</li>
                <li><strong>Prefer ID selectors</strong> for single elements</li>
                <li><strong>Scope your searches</strong> to smaller DOM subtrees</li>
                <li><strong>Use context parameter</strong> in query methods when possible</li>
                <li><strong>Avoid universal selectors</strong> (*) in production</li>
            </ul>
        </div>

        <div class="code-block">
// Good: Scoped search
const sidebar = document.getElementById('sidebar');
const sidebarLinks = sidebar.querySelectorAll('a'); // Faster

// Bad: Global search
const allLinks = document.querySelectorAll('#sidebar a'); // Slower
        </div>

        <h2>8. Common Traversal Patterns</h2>

        <h3>Form Validation Helper</h3>
        <div class="code-block">
function validateForm(formElement) {
    const requiredFields = formElement.querySelectorAll('[required]');
    const errors = [];
    
    requiredFields.forEach(field => {
        if (!field.value.trim()) {
            errors.push({
                field: field.name,
                message: `${field.labels[0].textContent} is required`,
                element: field
            });
            
            // Find or create error display element
            let errorDisplay = field.parentElement.querySelector('.error-message');
            if (!errorDisplay) {
                errorDisplay = document.createElement('div');
                errorDisplay.className = 'error-message';
                field.parentElement.appendChild(errorDisplay);
            }
            errorDisplay.textContent = errors[errors.length - 1].message;
        }
    });
    
    return errors;
}
        </div>

        <h3>Menu Navigation Helper</h3>
        <div class="code-block">
function createMenuNavigator(menuElement) {
    const items = menuElement.querySelectorAll('li');
    let currentIndex = 0;
    
    return {
        next() {
            if (currentIndex < items.length - 1) {
                items[currentIndex].classList.remove('focused');
                currentIndex++;
                items[currentIndex].classList.add('focused');
            }
        },
        
        previous() {
            if (currentIndex > 0) {
                items[currentIndex].classList.remove('focused');
                currentIndex--;
                items[currentIndex].classList.add('focused');
            }
        },
        
        select() {
            const currentItem = items[currentIndex];
            const link = currentItem.querySelector('a');
            if (link) {
                link.click();
            }
        },
        
        getCurrentItem() {
            return items[currentIndex];
        }
    };
}

// Usage
const nav = createMenuNavigator(document.getElementById('mainMenu'));
// Arrow key navigation could trigger nav.next(), nav.previous(), etc.
        </div>

        <h3>Component Finder</h3>
        <div class="code-block">
function findComponent(element, componentType) {
    // Look up the tree for a component container
    let current = element;
    while (current && current !== document.body) {
        if (current.classList.contains(`component-${componentType}`)) {
            return current;
        }
        current = current.parentElement;
    }
    return null;
}

function getComponentData(componentElement) {
    // Extract data from component
    const data = {};
    const dataElements = componentElement.querySelectorAll('[data-value]');
    
    dataElements.forEach(el => {
        const key = el.dataset.key || el.className;
        const value = el.dataset.value || el.textContent;
        data[key] = value;
    });
    
    return data;
}

// Usage
const button = document.getElementById('saveButton');
const cardComponent = findComponent(button, 'card');
if (cardComponent) {
    const cardData = getComponentData(cardComponent);
    console.log(cardData);
}
        </div>

        <h2>9. Browser DevTools for Traversal</h2>

        <div class="info">
            <h3>Console Methods for DOM Exploration</h3>
            <div class="code-block">
// In browser console:

// Find elements
$('#myId')              // Same as document.getElementById('myId')
$$('.myClass')          // Same as document.querySelectorAll('.myClass')

// Inspect element relationships
$0.parentElement        // Parent of currently selected element
$0.children            // Children of currently selected element
$0.nextElementSibling  // Next sibling

// Path utilities
getEventListeners($0)  // See event listeners on element
dir($0)               // Detailed object inspection
        </div>
        </div>

        <h2>10. Error Handling and Edge Cases</h2>

        <div class="warning">
            <h3>Common Pitfalls</h3>
        </div>

        <div class="code-block">
function safeTraversal(element, operation) {
    try {
        // Check if element exists
        if (!element || !element.nodeType) {
            throw new Error('Invalid element provided');
        }
        
        // Check if element is still in DOM
        if (!document.contains(element)) {
            throw new Error('Element is not in the document');
        }
        
        return operation(element);
    } catch (error) {
        console.error('Traversal error:', error);
        return null;
    }
}

// Safe navigation functions
function safeGetParent(element) {
    return safeTraversal(element, el => el.parentElement);
}

function safeGetNextSibling(element) {
    return safeTraversal(element, el => el.nextElementSibling);
}

function safeQuerySelector(context, selector) {
    try {
        if (!context || typeof selector !== 'string') {
            return null;
        }
        return context.querySelector(selector);
    } catch (error) {
        console.error('Invalid selector:', selector, error);
        return null;
    }
}
        </div>

        <h2>11. Best Practices Summary</h2>

        <div class="success">
            <h3>✅ DO:</h3>
            <ul>
                <li>Cache frequently accessed elements</li>
                <li>Use specific selectors for better performance</li>
                <li>Check for element existence before traversal</li>
                <li>Use context parameter to scope searches</li>
                <li>Prefer modern query methods for complex selections</li>
                <li>Handle edge cases gracefully</li>
                <li>Use semantic HTML for easier traversal</li>
            </ul>
        </div>

        <div class="warning">
            <h3>❌ DON'T:</h3>
            <ul>
                <li>Perform repeated DOM queries in loops</li>
                <li>Use overly broad selectors like '*'</li>
                <li>Assume elements always exist</li>
                <li>Modify live collections while iterating</li>
                <li>Ignore browser compatibility for newer methods</li>
                <li>Create deeply nested traversal chains</li>
            </ul>
        </div>

        <h2>12. Practice Exercises</h2>

        <div class="info">
            <h3>Exercise 1: Element Inspector</h3>
            <p>Create a function that takes any element and returns detailed information about its position in the DOM tree, including all ancestors, siblings, and children.</p>
        </div>

        <div class="info">
            <h3>Exercise 2: Smart Search</h3>
            <p>Build a search function that can find elements by text content, partial text matches, or attribute values, with performance optimization.</p>
        </div>

        <div class="info">
            <h3>Exercise 3: Component Analyzer</h3>
            <p>Create a tool that analyzes a web page and identifies all components, their structure, and relationships.</p>
        </div>

        <div class="highlight">
            <strong>Remember:</strong> DOM traversal is about finding the most efficient path to the elements you need. Always consider performance, maintainability, and browser compatibility when choosing your traversal strategy.
        </div>
    </div>
</body>
</html>
